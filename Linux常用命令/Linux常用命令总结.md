# Linux常用命令

## 1. 为什么学习Linux终端命令?

- Linux刚面世时并没有图形界面，所有的操作全靠命令完成，如 磁盘操作、文件存取、目录操作、进程管理、文件权限 设定等  
- 在职场中，大量的 服务器维护工作 都是在 远程 通过 SSH 客户端 来完成的，并没有图形界面，所有的维护工作都需要通过命令来完成  
- 在职场中，作为后端程序员，必须要或多或少的掌握一些 Linux 常用的终端命令  
- Linux 发行版本的命令大概有 200 多个，但是常用的命令也就二三十个而已

## 2. 常用命令总览

| 序号  |      命令      |            对应英文             |           作用           |
| :---: | :------------: | :-----------------------------: | :----------------------: |
|   1   |       ls       |              list               |  查看当前文件夹下的内容  |
|   2   |  cd [目录名]   |        change directory         |        切换文件夹        |
|   3   |      pwd       |      print wrok directory       |    查看当前所在文件夹    |
|   4   | mkdir [目录名] |         make directory          |         创建目录         |
|   5   |  rm [文件名]   |             remove              |     删除指定的文件名     |
|   6   | touch [文件名] |              touch              | 如果文件不存在，新建文件 |
|   7   |       mv       |              move               |   移动文件或修改文件名   |
|   8   |       cp       |              copy               |         复制文件         |
|   9   |      cat       |           Concatenate           |           连接           |
|  10   |      grep      | Global Regular Expression Print |    全局正则表达式版本    |
|  11   |      find      |              find               |         查找文件         |
|  12   |     chmod      |           Change mode           |         改变模式         |
|  13   |      tar       |          Tape archive           |         解压文件         |
|  14   |     chown      |          Change owner           |        改变所有者        |
|  15   |       ln       |           Link files            |         链接文件         |
|  16   |      data      |              data               |         显示日期         |
|  17   |      kill      |              kill               |         终止进程         |
|  18   |      free      |              free               |     显示内存使用情况     |
|  19   |     clear      |              clear              |           清屏           |
|  20   |       su       |           switch user           |      切換到root用户      |
|  21   |       ps       |         Process Status          |         进程状态         |


## 3. linux命令详细用法

#### 1、ls命令

就是 list 的缩写，通过 ls 命令不仅可以查看 linux 文件夹包含的文件，而且可以查看文件权限(包括目录、文件夹、文件权限)查看目录信息等等。

**常用参数搭配：**

```
ls -a 列出目录所有文件，包含以.开始的隐藏文件
ls -A 列出除.及..的其它文件
ls -r 反序排列
ls -t 以文件修改时间排序
ls -S 以文件大小排序
ls -h 以易读大小显示
ls -l 除了文件名之外，还将文件的权限、所有者、文件大小等信息详细列出来
```

**实例：**

1. 按易读方式按时间反序排序，并显示文件详细信息
`ls -lhrt`
2. 按大小反序显示文件详细信息
`ls -lrS`
3. 列出当前目录中所有以"t"开头的目录的详细内容
`ls -l t*`
4. 列出文件绝对路径（不包含隐藏文件）
`ls | sed "s:^:`pwd`/:"`
5. 列出文件绝对路径（包含隐藏文件）
`find $pwd -maxdepth 1 | xargs ls -ld`

#### 2、cd 命令

切换当前目录至 dirName。
`cd [目录名]`

实例：

1. 进入根目录
`cd /`
2. 进入 "home" 目录
`cd ~`
3. 进入上一次工作路径
`cd -`
4. 把上个命令的参数作为cd参数使用。
`cd !$`

#### 3、pwd 命令

pwd 命令用于查看当前工作目录路径。

**实例：**

1. 查看当前路径
`pwd`
2. 查看软链接的实际路径
`pwd -P`

#### 4、mkdir 命令

mkdir 命令用于创建文件夹。

**常用参数搭配：**

```
-m: 对新建目录设置存取权限，也可以用 chmod 命令设置;
-p: 可以是一个路径名称。此时若路径中的某些目录尚不存在,加上此选项后，  
系统将自动建立好那些尚不在的目录，即一次可以建立多个目录。
```

**实例：**

1. 当前工作目录下创建名为 t的文件夹
`mkdir t`
2. 在 tmp 目录下创建路径为 test/t1/t 的目录，若不存在，则创建：
`mkdir -p /tmp/test/t1/t`

#### 5、rm 命令

删除一个目录中的一个或多个文件或目录，如果没有使用 -r 选项，则 rm 不会删除目录。如果使用 rm 来删除文件，通常仍可以将该文件恢复原状。
`rm [选项] 文件…`

**实例：**

1. 删除任何 .log 文件，删除前逐一询问确认：
`rm -i *.log`

2. 删除 test 子目录及子目录中所有档案删除，并且不用一一确认：
`rm -rf test`

3. 删除以 -f 开头的文件
`rm -- -f*`

#### 6、touch 命令

Linux touch命令用于修改文件或者目录的时间属性，包括存取时间和更改时间。若文件不存在，系统会建立一个新的文件。

`ls -l 可以显示档案的时间记录`

`touch [-acfm][-d<日期时间>][-r<参考文件或目录>] [-t<日期时间>][--help][--version][文件或目录…]`

**参数说明：**
```
a 改变档案的读取时间记录。
m 改变档案的修改时间记录。
c 假如目的档案不存在，不会建立新的档案。与 --no-create 的效果一样。
f 不使用，是为了与其他 unix 系统的相容性而保留。
r 使用参考档的时间记录，与 --file 的效果一样。
d 设定时间与日期，可以使用各种不同的格式。
t 设定档案的时间记录，格式与 date 指令相同。
--no-create 不会建立新档案。
--help 列出指令格式。
--version 列出版本讯息。
```

**实例：**

1. 使用指令"touch"修改文件"testfile"的时间属性为当前系统时间，输入如下命令：
`touch testfile`   #修改文件的时间属性 

2. 使用指令"touch"时，如果指定的文件不存在，则将创建一个新的空白文件。例如，在当前目录下，使用该指令创建一个空白文件"file"，输入如下命令：
`touch file`  #创建一个名为“file”的新的空白文件 

#### 7、mv 命令

**移动** 文件或 **修改** 文件名，根据第二参数类型（如目录，则移动文件；如为文件则重命令该文件）。

当第二个参数为目录时，第一个参数可以是多个以空格分隔的文件或目录，然后移动第一个参数指定的多个文件到第二个参数指定的目录中。

**实例：**

1. 将文件 test.log 重命名为 test1.txt
`mv test.log test1.txt`

2. 将文件 log1.txt,log2.txt,log3.txt 移动到根的 test3 目录中
`mv llog1.txt log2.txt log3.txt /test3`

3. 将文件 file1 改名为 file2，如果 file2 已经存在，则询问是否覆盖
`mv -i log1.txt log2.txt`

4. 移动当前文件夹下的所有文件到上一级目录
`mv * ../`

#### 8、cp 命令

将源文件复制至目标文件，或将多个源文件复制至目标目录。

**注意：** 命令行复制，如果目标文件已经存在会提示是否覆盖，而在 shell 脚本中，如果不加 -i 参数，则不会提示，而是直接覆盖！

**常用参数搭配：**

```
-i 提示
-r 复制目录及目录内所有项目
-a 复制的文件与原文件时间一样
```

**实例：**

1. 复制 a.txt 到 test 目录下，保持原文件时间，如果原文件存在提示是否覆盖。
`cp -ai a.txt test`

2. 为 a.txt 建议一个链接（快捷方式）
`cp -s a.txt link_a.txt`

#### 9、cat 命令

cat 主要有三大功能：

1. 一次显示整个文件:
`cat filename`

2. 从键盘创建一个文件:
`cat > filename`
只能创建新文件，不能编辑已有文件。

3. 将几个文件合并为一个文件:
`cat file1 file2 > file`

    ```
    -b 对非空输出行号
    -n 输出所有行号
    ```

**实例：**

1. 把 log2012.log 的文件内容加上行号后输入 log2013.log 这个文件里
`cat -n log2012.log log2013.log`

2. 把 log2012.log 和 log2013.log 的文件内容加上行号（空白行不加）之后将内容附加到 log.log 里
`cat -b log2012.log log2013.log log.log`

3. 使用 here doc 生成新文件
`cat >log.txt <<EOF`

>Hello
>World
>PWD=$(pwd)
>EOF

ls -l log.txt
cat log.txt
Hello
World
PWD=/opt/soft/test

4. 反向列示

    ```
    tac log.txt
    PWD=/opt/soft/test
    World
    Hello
    ```

#### 10、grep 命令

强大的文本搜索命令，grep(Global Regular Expression Print) 全局正则表达式搜索。

grep 的工作方式是这样的，它在一个或多个文件中搜索字符串模板。如果模板包括空格，则必须被引用，模板后的所有字符串被看作文件名。搜索的结果被送到标准输出，不影响原文件内容。

**命令格式：**
`grep [option] pattern file|dir`

**常用参数：**
```
-A n --after-context显示匹配字符后n行
-B n --before-context显示匹配字符前n行
-C n --context 显示匹配字符前后n行
-c --count 计算符合样式的列数
-i 忽略大小写
-l 只列出文件内容符合指定的样式的文件名称
-f 从文件中读取关键词
-n 显示匹配内容的所在文件中行数
-R 递归查找文件夹
```

**grep 的规则表达式:**
```
^  #锚定行的开始 如：'^grep'匹配所有以grep开头的行。 
$  #锚定行的结束 如：'grep$'匹配所有以grep结尾的行。 
.  #匹配一个非换行符的字符 如：'gr.p'匹配gr后接一个任意字符，然后是p。  
*  #匹配零个或多个先前字符 如：'*grep'匹配所有一个或多个空格后紧跟grep的行。
.*   #一起用代表任意字符。  
[]   #匹配一个指定范围内的字符，如'[Gg]rep'匹配Grep和grep。 
[^]  #匹配一个不在指定范围内的字符，如：'[^A-FH-Z]rep'匹配不包含A-R和T-Z的一个字母开头，紧跟rep的行。  
\(..\)  #标记匹配字符，如'\(love\)'，love被标记为1。   
\<      #锚定单词的开始，如:'\<grep'匹配包含以grep开头的单词的行。
\>      #锚定单词的结束，如'grep\>'匹配包含以grep结尾的单词的行。
x\{m\}  #重复字符x，m次，如：'0\{5\}'匹配包含5个o的行。 
x\{m,\}  #重复字符x,至少m次，如：'o\{5,\}'匹配至少有5个o的行。  
x\{m,n\}  #重复字符x，至少m次，不多于n次，如：'o\{5,10\}'匹配5--10个o的行。  
\w    #匹配文字和数字字符，也就是[A-Za-z0-9]，如：'G\w*p'匹配以G后跟零个或多个文字或数字字符，然后是p。  
\W    #\w的反置形式，匹配一个或多个非单词字符，如点号句号等。  
\b    #单词锁定符，如: '\bgrep\b'只匹配grep。
```

**实例：**

1. 查找指定进程
`ps -ef | grep svn`

2. 查找指定进程个数
`ps -ef | grep svn -c`

3. 从文件中读取关键词
`cat test1.txt | grep -f key.log`

4. 从文件夹中递归查找以grep开头的行，并只列出文件
`grep -lR '^grep' /tmp`

5. 查找非x开关的行内容
`grep '^[^x]' test.txt`

6. 显示包含 ed 或者 at 字符的内容行
`grep -E 'ed|at' test.txt`

#### 11、find 命令

用于在文件树中查找文件，并作出相应的处理。

**命令格式：**
`find pathname -options [-print -exec -ok ...]`

**命令参数：**
```
pathname: find命令所查找的目录路径。例如用.来表示当前目录，用/来表示系统根目录。
-print：  find命令将匹配的文件输出到标准输出。
-exec：   find命令对匹配的文件执行该参数所给出的shell命令。
          相应命令的形式为'command' {  } \;，注意{   }和\；之间的空格。
-ok：     和-exec的作用相同，只不过以一种更为安全的模式来执行该参数所给出的shell命令，
          在执行每一个命令之前，都会给出提示，让用户来确定是否执行。
```

**命令选项：**
```
-name 按照文件名查找文件
-perm 按文件权限查找文件
-user 按文件属主查找文件
-group  按照文件所属的组来查找文件。
-type  查找某一类型的文件，诸如：
   b - 块设备文件
   d - 目录
   c - 字符设备文件
   l - 符号链接文件
   p - 管道文件
   f - 普通文件

-size n :[c] 查找文件长度为n块文件，带有c时表文件字节大小
-amin n   查找系统中最后N分钟访问的文件
-atime n  查找系统中最后n*24小时访问的文件
-cmin n   查找系统中最后N分钟被改变文件状态的文件
-ctime n  查找系统中最后n*24小时被改变文件状态的文件
-mmin n   查找系统中最后N分钟被改变文件数据的文件
-mtime n  查找系统中最后n*24小时被改变文件数据的文件
          (用减号-来限定更改时间在距今n日以内的文件，而用加号+来限定更改时间在距今n日以前的文件。 )
-maxdepth n 最大查找目录深度
-prune 选项来指出需要忽略的目录。在使用-prune选项时要当心，因为如果你同时使用了-depth选项，那么-prune选项就会被find命令忽略
-newer 如果希望查找更改时间比某个文件新但比另一个文件旧的所有文件，可以使用-newer选项
```

**实例：**

1. 查找 48 小时内修改过的文件
`find -atime -2`

2. 在当前目录查找 以 .log 结尾的文件。 . 代表当前目录
`find ./ -name '*.log'`

3. 查找 /opt 目录下 权限为 777 的文件
`find /opt -perm 777`

4. 查找大于 1K 的文件
`find -size +1000c`

5. 查找等于 1000 字符的文件
`find -size 1000c`

#### 12、chmod 命令

用于改变 linux 系统文件或目录的访问权限。用它控制文件或目录的访问权限。该命令有两种用法。一种是包含字母和操作符表达式的文字设定法；另一种是包含数字的数字设定法。

每一文件或目录的访问权限都有三组，每组用三位表示，分别为文件属主的读、写和执行权限；与属主同组的用户的读、写和执行权限；系统中其他用户的读、写和执行权限。可使用 ls -l test.txt 查找。

**以文件 log2012.log 为例：**

-rw-r--r-- 1 root root 296K 11-13 06:03 log2012.log
第一列共有 10 个位置，第一个字符指定了文件类型。在通常意义上，一个目录也是一个文件。如果第一个字符是横线，表示是一个非目录的文件。如果是 d，表示是一个目录。从第二个字符开始到第十个 9 个字符，3 个字符一组，分别表示了 3 组用户对文件或者目录的权限。权限字符用横线代表空许可，r 代表只读，w 代表写，x 代表可执行。

**常用参数：**
```
-c 当发生改变时，报告处理信息
-R 处理指定目录以及其子目录下所有文件
权限范围：

u ：目录或者文件的当前的用户
g ：目录或者文件的当前的群组
o ：除了目录或者文件的当前用户或群组之外的用户或者群组
a ：所有的用户及群组
权限代号：

r ：读权限，用数字4表示
w ：写权限，用数字2表示
x ：执行权限，用数字1表示
- ：删除权限，用数字0表示
s ：特殊权限
```

***实例：**

1. 增加文件 t.log 所有用户可执行权限
`chmod a+x t.log`

2. 撤销原来所有的权限，然后使拥有者具有可读权限,并输出处理信息
`chmod u=r t.log -c`

3. 给 file 的属主分配读、写、执行(7)的权限，给file的所在组分配读、执行(5)的权限，给其他用户分配执行(1)的权限
`chmod 751 t.log -c（或者：chmod u=rwx,g=rx,o=x t.log -c)`

4. 将 test 目录及其子目录所有文件添加可读权限
`chmod u+r,g+r,o+r -R text/ -c`

#### 13、tar 命令

用来压缩和解压文件。tar 本身不具有压缩功能，只具有打包功能，有关压缩及解压是调用其它的功能来完成。

弄清两个概念：打包和压缩。打包是指将一大堆文件或目录变成一个总的文件；压缩则是将一个大的文件通过一些压缩算法变成一个小文件

**常用参数：**
```
-c 建立新的压缩文件
-f 指定压缩文件
-r 添加文件到已经压缩文件包中
-u 添加改了和现有的文件到压缩包中
-x 从压缩包中抽取文件
-t 显示压缩文件中的内容
-z 支持gzip压缩
-j 支持bzip2压缩
-Z 支持compress解压文件
-v 显示操作过程
```

**有关 gzip 及 bzip2 压缩:**

- gzip 实例：压缩 gzip fileName .tar.gz 和.tgz  解压：gunzip filename.gz 或 gzip -d filename.gz
          对应：tar zcvf filename.tar.gz     tar zxvf filename.tar.gz

- bz2实例：压缩 bzip2 -z filename .tar.bz2 解压：bunzip filename.bz2或bzip -d filename.bz2
       对应：tar jcvf filename.tar.gz         解压：tar jxvf filename.tar.bz2

**实例：**

1. 将文件全部打包成 tar 包
`tar -cvf log.tar 1.log,2.log 或tar -cvf log.*`

2. 将 /etc 下的所有文件及目录打包到指定目录，并使用 gz 压缩
`tar -zcvf /tmp/etc.tar.gz /etc`

3. 查看刚打包的文件内容（一定加z，因为是使用 gzip 压缩的）
`tar -ztvf /tmp/etc.tar.gz`

4. 要压缩打包 /home, /etc ，但不要 /home/dmtsai
`tar --exclude /home/dmtsai -zcvf myfile.tar.gz /home/* /etc`

#### 14、chown 命令

chown 将指定文件的拥有者改为指定的用户或组，用户可以是用户名或者用户 ID；组可以是组名或者组 ID；文件是以空格分开的要改变权限的文件列表，支持通配符。
```
-c 显示更改的部分的信息
-R 处理指定目录及子目录
```

**实例：**

1. 改变拥有者和群组 并显示改变信息
`chown -c mail:mail log2012.log`

2. 改变文件群组
`chown -c :mail t.log`

3. 改变文件夹及子文件目录属主及属组为 mail
`chown -cR mail: test/`

#### 15、ln 命令

功能是为文件在另外一个位置建立一个同步的链接，当在不同目录需要该问题时，就不需要为每一个目录创建同样的文件，通过 ln 创建的链接（link）减少磁盘占用量。

**链接分类：软件链接及硬链接**

**软链接：**

    1.软链接，以路径的形式存在。类似于Windows操作系统中的快捷方式
    2.软链接可以 跨文件系统 ，硬链接不可以
    3.软链接可以对一个不存在的文件名进行链接
    4.软链接可以对目录进行链接

**硬链接：**

    1.硬链接，以文件副本的形式存在。但不占用实际空间。
    2.不允许给目录创建硬链接
    3.硬链接只有在同一个文件系统中才能创建

**需要注意：**

- **第一：** ln命令会保持每一处链接文件的同步性，也就是说，不论你改动了哪一处，其它的文件都会发生相同的变化；
- **第二：** ln的链接又分软链接和硬链接两种，软链接就是ln –s 源文件 目标文件，它只会在你选定的位置上生成一个文件的镜像，不会占用磁盘空间，硬链接 ln 源文件 目标文件，没有参数-s， 它会在你选定的位置上生成一个和源文件大小相同的文件，无论是软链接还是硬链接，文件都保持同步变化。
- **第三：** ln指令用在链接文件或目录，如同时指定两个以上的文件或目录，且最后的目的地是一个已经存在的目录，则会把前面指定的所有文件或目录复制到该目录中。若同时指定多个文件或目录，且最后的目的地并非是一个已存在的目录，则会出现错误信息。

**常用参数：**
```
-b 删除，覆盖以前建立的链接
-s 软链接（符号链接）
-v 显示详细处理过程
```

**实例：**

1. 给文件创建软链接，并显示操作信息
`ln -sv source.log link.log`

2. 给文件创建硬链接，并显示操作信息
`ln -v source.log link1.log`

3. 给目录创建软链接
`ln -sv /opt/soft/test/test3 /opt/soft/test/test5`

#### 16、date 命令

显示或设定系统的日期与时间。

**命令参数：**
```
-d<字符串> 　显示字符串所指的日期与时间。字符串前后必须加上双引号。
-s<字符串> 　根据字符串来设置日期与时间。字符串前后必须加上双引号。
-u 　显示GMT。
%H 小时(00-23)
%I 小时(00-12)
%M 分钟(以00-59来表示)
%s 总秒数。起算时间为1970-01-01 00:00:00 UTC。
%S 秒(以本地的惯用法来表示)
%a 星期的缩写。
%A 星期的完整名称。
%d 日期(以01-31来表示)。
%D 日期(含年月日)。
%m 月份(以01-12来表示)。
%y 年份(以00-99来表示)。
%Y 年份(以四位数来表示)。
```

**实例：**

1. 显示下一天
`date +%Y%m%d --date="+1 day"`  //显示下一天的日期

2. -d参数使用
```
date -d "nov 22"  今年的 11 月 22 日是星期三
date -d '2 weeks' 2周后的日期
date -d 'next monday' (下周一的日期)
date -d next-day +%Y%m%d（明天的日期）或者：date -d tomorrow +%Y%m%d
date -d last-day +%Y%m%d(昨天的日期) 或者：date -d yesterday +%Y%m%d
date -d last-month +%Y%m(上个月是几月)
date -d next-month +%Y%m(下个月是几月)
```

#### 17、kill 命令

发送指定的信号到相应进程。不指定型号将发送SIGTERM（15）终止指定进程。如果任无法终止该程序可用"-KILL" 参数，其发送的信号为SIGKILL(9) ，将强制结束进程，使用ps命令或者jobs 命令可以查看进程号。root用户将影响用户的进程，非root用户只能影响自己的进程。

**常用参数：**
```
-l  信号，若果不加信号的编号参数，则使用“-l”参数会列出全部的信号名称
-a  当处理当前进程时，不限制命令名和进程号的对应关系
-p  指定kill 命令只打印相关进程的进程号，而不发送任何信号
-s  指定发送信号
-u  指定用户
```

**实例：**

1. 先使用ps查找进程pro1，然后用kill杀掉
`kill -9 $(ps -ef | grep pro1)`

#### 18、free 命令

显示系统内存使用情况，包括物理内存、交互区内存(swap)和内核缓冲区内存。

**命令参数：**
```
-b 以Byte显示内存使用情况
-k 以kb为单位显示内存使用情况
-m 以mb为单位显示内存使用情况
-g 以gb为单位显示内存使用情况
-s<间隔秒数> 持续显示内存
-t 显示内存使用总合
```

**实例：**

1. 显示内存使用情况
```
free
free -k
free -m
```

2. 以总和的形式显示内存的使用信息
`free -t`

3. 周期性查询内存使用情况
`free -s 10`